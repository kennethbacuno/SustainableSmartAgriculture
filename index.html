<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sustainable Smart Agriculture</title>
    <link rel="icon" type="image/x-icon" href="logo_wbg.jpeg">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Fuzzy+Bubbles&family=Lily+Script+One&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Julius+Sans+One&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Navigation Bar for broader devices like tablets and pcs -->
    <div class="navbar">
        <span class="menu-icon" onclick="openNav()">
            <img src="menu.png" alt="Menu Icon" />
        </span>
        <a href="#" class="logo">
            <img src="logo.png" alt="Logo" />
        </a>
        <div class="nav-links">
            <a onclick="showSection('home')">Home</a>
            <a onclick="showSection('npk-updates')">NPK Updates</a>
            <a onclick="showSection('sensor-updates')">Sensor Updates</a>
            <a onclick="showSection('controls')">Controls</a>
            <a onclick="showSection('history')">History</a>
            <a onclick="showSection('about-app')">About App</a>
        </div>
    </div>

    <!-- Side Navigation Dashboard for more compact devices like mobile phones -->
    <div id="mySideNav" class="sidenav">
        <span class="closebtn" onclick="closeNav()">
            <img src="close.png" alt="Close Icon" />
        </span>
        <div class="card">
            <img src="logo.png" alt="Logo Placeholder" class="logo-placeholder">
        </div>
        <a onclick="showSection('home')">Home</a>
        <a onclick="showSection('npk-updates')">NPK Updates</a>
        <a onclick="showSection('sensor-updates')">Sensor Updates</a>
        <a onclick="showSection('controls')">Controls</a>
        <a onclick="showSection('history')">History</a>
        <a onclick="showSection('about-app')">About App</a>
    </div>

    <!-- Sections -->
    <div id="home" class="section">
        <img src="logo.png" alt="Logo" />
        <h1>Sustainable Smart Agriculture</h1>
        <p>Sprout a smile everyday.</p>
        <div class="dashboard">
            <h1>Sensors Dashboard</h1>
            <h1 class="dashboard-title">NPK Updates</h1>
            <span class="update-content">
                <img src="npk.png" alt="NPK Icon" />
                <div class="npk-values">
                    <p>Nitrogen: %NITROGEN%</p>
                    <p>Phosphorus: %PHOSPHORUS%</p>
                    <p>Potassium: %POTASSIUM%</p>
                </div>
            </span>
            <h1 class="dashboard-title">Soil Moisture Status</h1>
            <span class="update-content">
                <img src="soil_moisture.png" alt="Soil Moisture Icon" />
                <p>Soil Moisture: %SOIL_MOISTURE%</p>
            </span>
            <h1 class="dashboard-title">Water Container Status</h1>
            <span class="update-content">
                <img src="water_level.png" alt="water_level Icon" />
                <p>Water Level: %WATER_LEVEL%</p>
            </span>
        </div>
    </div>
    <div id="npk-updates" class="section" style="display: none;">
        <h1>NPK Updates</h1>
        <h2 class="design" id="currentNitro">Current Nitrogen: %NITROGEN%</h2>
        <div id="chart-nitrogen" class="container"></div>
        <h2 class="design" id="currentPhos">Current Phosphorus: %PHOSPHORUS%</h2>
        <div id="chart-phosphorus" class="container"></div>
        <h2 class="design" id="currentPota">Current Potassium: %POTASSIUM%</h2>
        <div id="chart-potassium" class="container"></div>
    </div>
    <div id="sensor-updates" class="section" style="display: none;">
        <h1>Sensor Updates</h1>
        <h2 class="design" id="currentMoisture">Current Moisture: %MOISTURE%</h2>
        <div class="legend">
            <div class="legend-item">
                <img src="wet.png" alt="Wet Icon" class="legend-icon">
                <span>0-500: Soil is too <strong>wet</strong></span>
            </div>
            <div class="legend-item">
                <img src="perfect.png" alt="Perfect Condition Icon" class="legend-icon">
                <span>501-749: Soil is in <strong>perfect condition</strong></span>
            </div>
            <div class="legend-item">
                <img src="dry.png" alt="Dry Icon" class="legend-icon">
                <span> 750 or greater: Soil is <strong>dry</strong></span>
            </div>
        </div>
        <div id="chart-moisture" class="container"></div>
        <div class="water-level-update">
            <img src="water_level.png" alt="Water Level Icon">
            <h2>Water Container Status</h2>
            <h1><strong>0%</strong></h1>
        </div>
    </div>
    <div id="controls" class="section" style="display: none;">
        <h1>Controllers</h1>
        <div class="control-card" id="water-control">
            <img class="control-img" src="water_pump.png" alt="Water Pump Icon" />
            <span class="control-info">
                <p>Water Pump: <strong>Off</strong></p>
                <label class="switch">
                    <input type="checkbox" id="toggleWaterPump" onclick="toggleWaterPump()">
                    <span class="slider"></span>
                </label>
            </span>
        </div>
        <div class="control-card" id="fertilizer-control">
            <img class="control-img" src="fertilizer_pump.png" alt="Fertilizer Pump Icon" />
            <span class="control-info">
                <p>Fertilizer Pump: <strong>Off</strong></p>
                <label class="switch">
                    <input type="checkbox" id="toggleFertilizerPump" onclick="toggleFertilizerPump()">
                    <span class="slider"></span>
                </label>
            </span>
        </div>
        <div class="control-card" id="roof-control">
            <img class="control-img" src="roof.png" alt="Roof Icon" />
            <span class="control-info">
                <p>Roof: <strong>Closed</strong></p>
                <label class="switch">
                    <input type="checkbox" id="toggleRoof" onclick="toggleRoof()">
                    <span class="slider"></span>
                </label>
            </span>
        </div>
    </div>
    <div id="history" class="section" style="display: none;">
        <h1>History</h1>
        <p>This is the history section.</p>
    </div>
    <div id="about-app" class="section" style="display: none;">
        <h1>About the App</h1>
        <p>Information about this application.</p>
    </div>
    <script src="script.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script>
        var chartT = new Highcharts.Chart({
            chart: { renderTo: 'chart-nitrogen' },
            title: {
                text: 'NPK: Nitrogen',
                style: {
                    fontSize: '18px',
                    fontWeight: 'bold',
                    color: '#4EA93C',
                    fontFamily: "'Fuzzy Bubbles', sans-serif"
                }
            },
            series: [{
                showInLegend: false,
                data: []
            }],
            plotOptions: {
                line: {
                    animation: false,
                    dataLabels: { enabled: true }
                },
                series: { color: '#059e8a' }
            },
            xAxis: {
                type: 'datetime',
                dateTimeLabelFormats: {
                    second: '%M:%S',
                    minute: '%H:%M',
                    hour: '%H:%M',
                    day: '%e. %b',
                    week: '%e. %b',
                    month: '%b \'%y',
                    year: '%Y'
                }
            },
            yAxis: {
                title: {
                    text: 'Nitrogen (mg/kg)',
                    style: {
                        fontSize: '12px',
                        fontWeight: 'light',
                        color: '#4EA93C',
                        fontFamily: "'Fuzzy Bubbles', sans-serif"
                    }
                }
            },
            credits: { enabled: false }
        });
        setInterval(function () {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var x = (new Date()).getTime(),
                        y = parseFloat(this.responseText);
                    if (chartT.series[0].data.length > 40) {
                        chartT.series[0].addPoint([x, y], true, true, true);
                    } else {
                        chartT.series[0].addPoint([x, y], true, false, true);
                    }
                    const paragraphElement = document.getElementById("currentNitro");
                    if (paragraphElement) {
                        paragraphElement.textContent = "Current Nitrogen (mg/kg): " + this.response + "mg/kg";
                    }
                }
            };
            xhttp.open("GET", "/temperature", true);
            xhttp.send();
        }, 1000);

        var chartH = new Highcharts.Chart({
            chart: { renderTo: 'chart-phosphorus' },
            title: {
                text: 'NPK: Phosphorus',
                style: {
                    fontSize: '18px',
                    fontWeight: 'bold',
                    color: '#4EA93C',
                    fontFamily: "'Fuzzy Bubbles', sans-serif"
                }
            },
            series: [{
                showInLegend: false,
                data: []
            }],
            plotOptions: {
                line: {
                    animation: false,
                    dataLabels: { enabled: true }
                }
            },
            xAxis: {
                type: 'datetime',
                dateTimeLabelFormats: {
                    second: '%M:%S',
                    minute: '%H:%M',
                    hour: '%H:%M',
                    day: '%e. %b',
                    week: '%e. %b',
                    month: '%b \'%y',
                    year: '%Y'
                }
            },
            yAxis: {
                title: {
                    text: 'Phosphorus (mg/kg)',
                    style: {
                        fontSize: '12px',
                        fontWeight: 'light',
                        color: '#4EA93C',
                        fontFamily: "'Fuzzy Bubbles', sans-serif"
                    }
                }
            },
            credits: { enabled: false }
        });
        setInterval(function () {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var x = (new Date()).getTime(),
                        y = parseFloat(this.responseText);
                    if (chartH.series[0].data.length > 40) {
                        chartH.series[0].addPoint([x, y], true, true, true);
                    } else {
                        chartH.series[0].addPoint([x, y], true, false, true);
                    }
                    const paragraphElement = document.getElementById("currentPhos");
                    if (paragraphElement) {
                        paragraphElement.textContent = "Current Phosphorus (mg/kg): " + this.response + "mg/kg";
                    }
                }
            };
            xhttp.open("GET", "/humidity", true);
            xhttp.send();
        }, 1000);

        var chartP = new Highcharts.Chart({
            chart: { renderTo: 'chart-potassium' },
            title: {
                text: 'NPK: Potassium',
                style: {
                    fontSize: '18px',
                    fontWeight: 'bold',
                    color: '#4EA93C',
                    fontFamily: "'Fuzzy Bubbles', sans-serif"
                }
            },
            series: [{
                showInLegend: false,
                data: []
            }],
            plotOptions: {
                line: {
                    animation: false,
                    dataLabels: { enabled: true }
                },
                series: { color: '#18009c' }
            },
            xAxis: {
                type: 'datetime',
                dateTimeLabelFormats: {
                    second: '%M:%S',
                    minute: '%H:%M',
                    hour: '%H:%M',
                    day: '%e. %b',
                    week: '%e. %b',
                    month: '%b \'%y',
                    year: '%Y'
                }
            },
            yAxis: {
                title: {
                    text: 'Potassium (mg/kg)',
                    style: {
                        fontSize: '12px',
                        fontWeight: 'light',
                        color: '#4EA93C',
                        fontFamily: "'Fuzzy Bubbles', sans-serif"
                    }
                }
            },
            credits: { enabled: false }
        });
        setInterval(function () {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var x = (new Date()).getTime(),
                        y = parseFloat(this.responseText);
                    if (chartP.series[0].data.length > 40) {
                        chartP.series[0].addPoint([x, y], true, true, true);
                    } else {
                        chartP.series[0].addPoint([x, y], true, false, true);
                    }
                    const paragraphElement = document.getElementById("currentPota");
                    if (paragraphElement) {
                        paragraphElement.textContent = "Current Potassium (mg/kg): " + this.response + "mg/kg";
                    }
                }
            };
            xhttp.open("GET", "/pressure", true);
            xhttp.send();
        }, 1000);

        var chartMoisture = new Highcharts.Chart({
            chart: { renderTo: 'chart-moisture' },
            title: {
                text: 'Soil Moisture',
                style: {
                    fontSize: '18px',
                    fontWeight: 'bold',
                    color: '#4EA93C',
                    fontFamily: "'Fuzzy Bubbles', sans-serif"
                }
            },
            series: [{
                showInLegend: false,
                data: []
            }],
            plotOptions: {
                line: {
                    animation: false,
                    dataLabels: { enabled: true }
                },
                series: { color: '#00aaff' }
            },
            xAxis: {
                type: 'datetime',
                dateTimeLabelFormats: {
                    second: '%M:%S',
                    minute: '%H:%M',
                    hour: '%H:%M',
                    day: '%e. %b',
                    week: '%e. %b',
                    month: '%b \'%y',
                    year: '%Y'
                }
            },
            yAxis: {
                title: {
                    text: 'Soil Moisture',
                    style: {
                        fontSize: '12px',
                        fontWeight: 'light',
                        color: '#4EA93C',
                        fontFamily: "'Fuzzy Bubbles', sans-serif"
                    }
                }
            },
            credits: { enabled: false }
        });

        setInterval(function () {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    var x = (new Date()).getTime(),
                        y = parseFloat(this.responseText);
                    console.log(y);
                    if (chartMoisture.series[0].data.length > 40) {
                        chartMoisture.series[0].addPoint([x, y], true, true, true);
                    } else {
                        chartMoisture.series[0].addPoint([x, y], true, false, true);
                    }
                    const paragraphElement = document.getElementById("currentMoisture");
                    if (paragraphElement) {
                        paragraphElement.textContent = "Current Soil Moisture: " + y;
                    }
                }
            };
            xhttp.open("GET", "/moisture", true);
            xhttp.send();
        }, 1000);
    </script>
</body>

</html>